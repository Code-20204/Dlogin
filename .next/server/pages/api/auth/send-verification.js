"use strict";(()=>{var e={};e.id=304,e.ids=[304],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6326:e=>{e.exports=import("resend")},6113:e=>{e.exports=require("crypto")},2177:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.r(a),t.d(a,{config:()=>u,default:()=>d,routeModule:()=>c});var i=t(1802),s=t(7153),n=t(6249),o=t(8505),l=e([o]);o=(l.then?(await l)():l)[0];let d=(0,n.l)(o,"default"),u=(0,n.l)(o,"config"),c=new i.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/auth/send-verification",pathname:"/api/auth/send-verification",bundlePath:"",filename:""},userland:o});r()}catch(e){r(e)}})},4637:(e,a,t)=>{t.d(a,{_:()=>s});var r=t(3524);let i=globalThis,s=i.prisma??new r.PrismaClient({log:["query"]})},8505:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.r(a),t.d(a,{default:()=>handler});var i=t(4637),s=t(7818),n=t(6113),o=t.n(n),l=e([s]);async function handler(e,a){if("POST"!==e.method)return a.status(405).json({message:"Method not allowed"});let{email:t}=e.body;if(!t)return a.status(400).json({message:"Email is required"});try{let e=await i._.user.findUnique({where:{email:t}});if(!e)return a.status(404).json({message:"User not found"});if(e.isEmailVerified)return a.status(400).json({message:"Email already verified"});let r=o().randomBytes(32).toString("hex"),n=new Date(Date.now()+864e5);await i._.user.update({where:{id:e.id},data:{emailVerificationToken:r,emailTokenExpiry:n}});let l=`http://localhost:3000/api/auth/verify-email?token=${r}`,d=await (0,s.zk)(t,e.name||t.split("@")[0],l);if(!d.success)return console.error("Failed to send verification email:",d.error),a.status(500).json({message:"Failed to send verification email"});a.status(200).json({message:"Verification email sent successfully",expiresAt:n})}catch(e){console.error("Send verification error:",e),a.status(500).json({message:"Internal server error"})}}s=(l.then?(await l)():l)[0],r()}catch(e){r(e)}})}};var a=require("../../../webpack-api-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),t=a.X(0,[222,818],()=>__webpack_exec__(2177));module.exports=t})();