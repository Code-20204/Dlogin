"use strict";(()=>{var e={};e.id=604,e.ids=[604],e.modules={2104:e=>{e.exports=require("@next-auth/prisma-adapter")},3524:e=>{e.exports=require("@prisma/client")},8432:e=>{e.exports=require("bcryptjs")},557:e=>{e.exports=require("date-fns/endOfDay")},4038:e=>{e.exports=require("date-fns/isAfter")},3024:e=>{e.exports=require("date-fns/isBefore")},7585:e=>{e.exports=require("date-fns/startOfDay")},3227:e=>{e.exports=require("next-auth")},2113:e=>{e.exports=require("next-auth/next")},7449:e=>{e.exports=require("next-auth/providers/credentials")},7459:e=>{e.exports=require("next-auth/providers/github")},3598:e=>{e.exports=require("next-auth/providers/google")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6326:e=>{e.exports=import("resend")},5194:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>l,default:()=>u,routeModule:()=>c});var s=r(1802),i=r(7153),n=r(6249),d=r(9710),o=e([d]);d=(o.then?(await o)():o)[0];let u=(0,n.l)(d,"default"),l=(0,n.l)(d,"config"),c=new s.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/email/send-reminder",pathname:"/api/email/send-reminder",bundlePath:"",filename:""},userland:d});a()}catch(e){a(e)}})},9710:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>handler});var s=r(2113),i=r(8417),n=r(4637),d=r(7818);r(4038),r(3024);var o=r(7585),u=r.n(o),l=r(557),c=r.n(l),m=e([d]);async function handler(e,t){if("POST"!==e.method)return t.status(405).json({message:"Method not allowed"});try{let r=await (0,s.getServerSession)(e,t,i.authOptions);if(!r)return t.status(401).json({message:"Unauthorized"});let{type:a="overdue"}=e.body,o=r.user.id,l=await n._.user.findUnique({where:{id:o},select:{email:!0,name:!0}});if(!l)return t.status(404).json({message:"User not found"});let m=[],p=new Date,h=u()(p),f=c()(p);switch(a){case"overdue":m=await n._.listItem.findMany({where:{list:{userId:o},completed:!1,dueDate:{lt:h}},include:{list:{select:{title:!0}}},orderBy:{dueDate:"asc"}});break;case"today":m=await n._.listItem.findMany({where:{list:{userId:o},completed:!1,dueDate:{gte:h,lte:f}},include:{list:{select:{title:!0}}},orderBy:{dueDate:"asc"}});break;case"upcoming":let x=new Date;x.setDate(x.getDate()+3),m=await n._.listItem.findMany({where:{list:{userId:o},completed:!1,dueDate:{gte:h,lte:c()(x)}},include:{list:{select:{title:!0}}},orderBy:{dueDate:"asc"}});break;case"high_priority":m=await n._.listItem.findMany({where:{list:{userId:o},completed:!1,priority:"high"},include:{list:{select:{title:!0}}},orderBy:{createdAt:"desc"}});break;default:return t.status(400).json({message:"Invalid reminder type"})}if(0===m.length)return t.status(200).json({message:"No tasks found for reminder",count:0});let g=await (0,d.EX)(l.email,l.name,m);g.success?t.status(200).json({message:"Reminder email sent successfully",count:m.length,emailId:g.data.id}):t.status(500).json({message:"Failed to send reminder email",error:g.error})}catch(e){console.error("Send reminder error:",e),t.status(500).json({message:"Internal server error"})}}d=(m.then?(await m)():m)[0],a()}catch(e){a(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222,417,818],()=>__webpack_exec__(5194));module.exports=r})();