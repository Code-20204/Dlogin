"use strict";(()=>{var e={};e.id=895,e.ids=[895],e.modules={2104:e=>{e.exports=require("@next-auth/prisma-adapter")},3524:e=>{e.exports=require("@prisma/client")},8432:e=>{e.exports=require("bcryptjs")},6011:e=>{e.exports=require("date-fns/addDays")},557:e=>{e.exports=require("date-fns/endOfDay")},3864:e=>{e.exports=require("date-fns/endOfWeek")},4038:e=>{e.exports=require("date-fns/isAfter")},3024:e=>{e.exports=require("date-fns/isBefore")},7436:e=>{e.exports=require("date-fns/isEqual")},7585:e=>{e.exports=require("date-fns/startOfDay")},2659:e=>{e.exports=require("date-fns/startOfWeek")},3227:e=>{e.exports=require("next-auth")},2113:e=>{e.exports=require("next-auth/next")},7449:e=>{e.exports=require("next-auth/providers/credentials")},7459:e=>{e.exports=require("next-auth/providers/github")},3598:e=>{e.exports=require("next-auth/providers/google")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},7740:(e,t,r)=>{r.r(t),r.d(t,{config:()=>c,default:()=>p,routeModule:()=>f});var s={};r.r(s),r.d(s,{default:()=>handler});var a=r(1802),i=r(7153),n=r(6249),u=r(2113),o=r(8417),l=r(4637),d=r(6070);async function handler(e,t){let r=await (0,u.getServerSession)(e,t,o.authOptions);if(!r)return t.status(401).json({message:"Unauthorized"});let s=r.user.id;switch(e.method){case"GET":try{let e=await l._.list.findMany({where:{userId:s},include:{items:{orderBy:{createdAt:"desc"}},_count:{select:{items:!0}}},orderBy:{createdAt:"asc"}}),r=e.map(t=>{if("AUTO"===t.type&&t.rules){let r=e.flatMap(e=>e.items),s=(0,d.tr)(r,t.rules);return{...t,items:s,_count:{items:s.length}}}return t});t.status(200).json(r)}catch(e){console.error("Get lists error:",e),t.status(500).json({message:"Internal server error"})}break;case"POST":try{let{title:r,type:a="MANUAL",rules:i}=e.body;if(!r)return t.status(400).json({message:"Title is required"});if("AUTO"===a&&i){let e=i.filter(e=>!(0,d.fX)(e));if(e.length>0)return t.status(400).json({message:"Invalid automation rules",invalidRules:e})}let n=await l._.list.create({data:{title:r,type:a,rules:i||null,userId:s},include:{items:!0,_count:{select:{items:!0}}}});t.status(201).json(n)}catch(e){console.error("Create list error:",e),t.status(500).json({message:"Internal server error"})}break;default:t.status(405).json({message:"Method not allowed"})}}let p=(0,n.l)(s,"default"),c=(0,n.l)(s,"config"),f=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/lists",pathname:"/api/lists",bundlePath:"",filename:""},userland:s})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222,417,70],()=>__webpack_exec__(7740));module.exports=r})();