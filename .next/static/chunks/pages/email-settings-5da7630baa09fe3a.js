(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[982],{4297:function(e,s,t){"use strict";t.d(s,{Z:function(){return createLucideIcon}});var a=t(7294),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),createLucideIcon=(e,s)=>{let t=(0,a.forwardRef)(({color:t="currentColor",size:i=24,strokeWidth:c=2,absoluteStrokeWidth:l,className:n="",children:d,...x},m)=>(0,a.createElement)("svg",{ref:m,...r,width:i,height:i,stroke:t,strokeWidth:l?24*Number(c)/Number(i):c,className:["lucide",`lucide-${toKebabCase(e)}`,n].join(" "),...x},[...s.map(([e,s])=>(0,a.createElement)(e,s)),...Array.isArray(d)?d:[d]]));return t.displayName=`${e}`,t}},6953:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});var a=t(4297);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},1352:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});var a=t(4297);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,a.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9965:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/email-settings",function(){return t(2187)}])},9415:function(e,s,t){"use strict";t.d(s,{Z:function(){return AuthGuard}});var a=t(5893),r=t(3299),i=t(1163),c=t(7294);function AuthGuard(e){let{children:s}=e,{data:t,status:l}=(0,r.useSession)(),n=(0,i.useRouter)();return((0,c.useEffect)(()=>{if("loading"!==l&&!t){n.push("/login");return}},[t,l,n]),"loading"===l)?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"验证身份中..."})]})}):t?s:null}},2187:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return EmailSettings}});var a=t(5893),r=t(7294),i=t(3299),c=t(1163),l=t(9415),n=t(1352),d=t(4297);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,d.Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),m=(0,d.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var o=t(6953);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,d.Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);function EmailSettings(){var e;let{data:s}=(0,i.useSession)(),t=(0,c.useRouter)(),[d,u]=(0,r.useState)(!1),[j,g]=(0,r.useState)(""),[N,y]=(0,r.useState)(""),[p,b]=(0,r.useState)({overdue:!0,today:!0,upcoming:!1,highPriority:!1}),handleSendTestReminder=async e=>{u(!0),g("");try{let s=await fetch("/api/email/send-reminder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:e})}),t=await s.json();s.ok?(g("测试邮件发送成功！共发送了 ".concat(t.count," 个任务的提醒。")),y("success")):(g(t.message||"发送失败"),y("error"))}catch(e){g("发送失败，请稍后重试"),y("error")}finally{u(!1)}},f=[{key:"overdue",title:"过期任务提醒",description:"提醒您处理已过期的未完成任务",icon:(0,a.jsx)(n.Z,{className:"w-5 h-5 text-red-500"})},{key:"today",title:"今日到期提醒",description:"提醒您今天需要完成的任务",icon:(0,a.jsx)(x,{className:"w-5 h-5 text-orange-500"})},{key:"upcoming",title:"即将到期提醒",description:"提醒您未来3天内到期的任务",icon:(0,a.jsx)(x,{className:"w-5 h-5 text-blue-500"})},{key:"high_priority",title:"高优先级任务",description:"提醒您处理高优先级的未完成任务",icon:(0,a.jsx)(m,{className:"w-5 h-5 text-purple-500"})}];return(0,a.jsx)(l.Z,{children:(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-indigo-100 rounded-lg",children:(0,a.jsx)(o.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"邮件设置"}),(0,a.jsx)("p",{className:"text-gray-600",children:"管理您的邮件通知偏好和测试邮件功能"})]})]})}),j&&(0,a.jsx)("div",{className:"mb-6 p-4 rounded-lg ".concat("success"===N?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["success"===N?(0,a.jsx)(m,{className:"w-5 h-5"}):(0,a.jsx)(n.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:j})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"card-header",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[(0,a.jsx)(h,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"测试邮件功能"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"测试不同类型的任务提醒邮件"})]}),(0,a.jsx)("div",{className:"card-body space-y-4",children:f.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[e.icon,(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})]}),(0,a.jsx)("button",{onClick:()=>handleSendTestReminder(e.key),disabled:d,className:"btn-primary text-sm px-3 py-1.5",children:d?"发送中...":"测试发送"})]},e.key))})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"邮件配置信息"})]})}),(0,a.jsxs)("div",{className:"card-body space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"当前邮箱"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:null==s?void 0:null===(e=s.user)||void 0===e?void 0:e.email})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"发送服务"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:"Resend"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"发送邮箱"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:"super@studyhard.qzz.io"})]})]}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"\uD83D\uDCA1 使用提示"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,a.jsx)("li",{children:"• 测试邮件会发送到您的注册邮箱"}),(0,a.jsx)("li",{children:"• 只有符合条件的任务才会被包含在提醒中"}),(0,a.jsx)("li",{children:"• 如果没有符合条件的任务，会显示相应提示"}),(0,a.jsx)("li",{children:"• 邮件发送可能需要几分钟时间"})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("button",{onClick:()=>t.push("/dashboard"),className:"btn-secondary w-full",children:"返回仪表板"})})]})]})]}),(0,a.jsxs)("div",{className:"mt-8 card",children:[(0,a.jsx)("div",{className:"card-header",children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"邮件功能说明"})}),(0,a.jsx)("div",{className:"card-body",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,a.jsx)(o.Z,{className:"w-6 h-6 text-green-600"})}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"欢迎邮件"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"用户注册成功后自动发送欢迎邮件，介绍系统功能"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,a.jsx)(x,{className:"w-6 h-6 text-orange-600"})}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"任务提醒"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"根据任务状态和截止日期发送个性化提醒邮件"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,a.jsx)(h,{className:"w-6 h-6 text-red-600"})}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"密码重置"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"安全的密码重置流程，包含时效性验证"})]})]})})]})]})})})}},1163:function(e,s,t){e.exports=t(9974)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=9965)}),_N_E=e.O()}]);